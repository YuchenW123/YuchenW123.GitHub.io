window.__require=function t(e,o,r){function n(c,a){if(!o[c]){if(!e[c]){var s=c.split("/");if(s=s[s.length-1],!e[s]){var d="function"==typeof __require&&__require;if(!a&&d)return d(s,!0);if(i)return i(s,!0);throw new Error("Cannot find module '"+c+"'")}c=s}var u=o[c]={exports:{}};e[c][0].call(u.exports,function(t){return n(e[c][1][t]||t)},u,u.exports,t,e,o,r)}return o[c].exports}for(var i="function"==typeof __require&&__require,c=0;c<r.length;c++)n(r[c]);return n}({FastForward:[function(t,e,o){"use strict";cc._RF.push(e,"4ab6eXfk19Dr7kveyDuyg+2","FastForward");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.game=null,e}return n(e,t),e.prototype._toggleSpeed=function(){1===this.game.getComponent("Game").timeSpeed?this.game.getComponent("Game").timeSpeed=15:this.game.getComponent("Game").timeSpeed=1,255==this.node.parent.color.r?this.node.parent.color.set(cc.color(27,255,100)):this.node.parent.color.set(cc.color(255,255,255))},e.prototype.onLoad=function(){var t=this;this.node.on(cc.Node.EventType.TOUCH_START,function(){return t._toggleSpeed()})},e.prototype.onDestroy=function(){var t=this;this.node.off(cc.Node.EventType.TOUCH_START,function(){return t._toggleSpeed()})},e.prototype.start=function(){},i([s(cc.Node)],e.prototype,"game",void 0),i([a],e)}(cc.Component);o.default=d,cc._RF.pop()},{}],Game:[function(t,e,o){"use strict";cc._RF.push(e,"7622el0GttIdZdtTe6Pq2SQ","Game");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./ScheduleBar"),a=cc._decorator,s=a.ccclass,d=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.positiveTaskItemPrefab=null,e.mutualTaskItemPrefab=null,e.negativeTaskItemPrefab=null,e.clock=null,e.scheduleBarArea=null,e.taskItemArea=null,e.moodBar=null,e.gameOverNode=null,e.timeSpeed=1,e.timer=0,e.moodValue=0,e.scheduleChart={duration:360,moodLimit:50,startMood:0,startTime:660,timeSpeed:1},e.taskNodes=[],e.tasks=[{text:"\u6d17\u8138",moodEffect:-10,triggerFailureString:"\u600e\u4e48\u7070\u5934\u571f\u8138\u89c1\u4eba\u554a\uff01",duration:60,fixedTime:-1},{text:"\u5316\u5986",moodEffect:-25,triggerFailureString:"\u4e0d\u5316\u5986\u7edd\u5bf9\u4e0d\u4f1a\u51fa\u95e8\u7684\uff01",duration:60,fixedTime:-1},{text:"\u8d77\u5e8a",moodEffect:-25,duration:45,fixedTime:0},{text:"\u62c9\u5c4e",moodEffect:25,duration:45,fixedTime:-1},{text:"\u8d56\u5e8a",moodEffect:50,duration:45,fixedTime:-1},{text:"\u6311\u7a7f\u8863\u670d",moodEffect:-50,duration:45,fixedTime:-1,triggerFailureString:"\u7a7f\u8863\u670d\u7a7f\u592a\u4e45\u4e86!"},{text:"\u78e8\u8e6d",moodEffect:0,duration:45,fixedTime:150}],e}return n(e,t),e.prototype.setTimeSpeed=function(t){this.timeSpeed=t},e.prototype.setTimer=function(t){this.timer=t},e.prototype.setMoodValue=function(t){this.moodValue=t,this.moodBar.getComponent("MoodBar").setTargetMoodValue(t)},e.prototype.addMoodValue=function(t){this.moodValue+=t,this.moodBar.getComponent("MoodBar").setTargetMoodValue(this.moodValue)},e.prototype._spawnNewTaskItem=function(t){var e="00"+Math.random(),o=null;return(o=t.moodEffect>0?cc.instantiate(this.negativeTaskItemPrefab):0==t.moodEffect?cc.instantiate(this.mutualTaskItemPrefab):cc.instantiate(this.positiveTaskItemPrefab)).getComponent(cc.Sprite).type=cc.Sprite.Type.SLICED,o.getComponent("TaskItem").task=t,o.getComponent("TaskItem").id=e,o.width=Math.floor(this.scheduleBarArea.getChildByName("ScheduleBar").width*t.duration/this.scheduleChart.duration*.9),o.height=.9*this.scheduleBarArea.getChildByName("ScheduleBar").height,o.getComponent("TaskItem").scheduleBar=this.scheduleBarArea.getChildByName("ScheduleBar"),o.getComponent("TaskItem").taskItemAreaLayout=this.taskItemArea,t.fixedTime>=0?(o.getComponent("TaskItem").canMove=!1,this.scheduleBarArea.getComponentInChildren("ScheduleBar").node.addChild(o),o.position=this.scheduleBarArea.getComponentInChildren("ScheduleBar").insertFixedTask(t.fixedTime,t.duration,o)):(this.taskItemArea.addChild(o),this.taskItemArea.getComponent("TaskItemAreaLayout").rearrange()),o},e.prototype.gameOver=function(){this.node.getChildByName("GameOverScreen").active=!0},e.prototype.perfectWin=function(){this.win()},e.prototype.win=function(){this.node.getChildByName("WinScreen").active=!0},e.prototype.lose=function(t){this.node.getChildByName("LoseScreen").getChildByName("label").getComponent(cc.Label).string=t,this.node.getChildByName("LoseScreen").active=!0},e.prototype.gameResult=function(){this.timeSpeed=0;for(var t=0,e=this.taskNodes;t<e.length;t++){var o=e[t];if(0==o.getComponent("TaskItem").used&&o.getComponent("TaskItem").task.moodEffect<0){var r=o.getComponent("TaskItem").task.triggerFailureString;return void this.lose(r)}}this.moodValue>=0?this.perfectWin():this.win()},e.prototype.onLoad=function(){this.scheduleBarArea.getChildByName("StartTime").getComponent(cc.Label).string=p(this.scheduleChart.startTime),this.scheduleBarArea.getChildByName("EndTime").getComponent(cc.Label).string=p(this.scheduleChart.startTime+this.scheduleChart.duration),this.node.getChildByName("WinScreen").active=!1,this.scheduleBarArea.x=.48*-this.node.width,this.scheduleBarArea.width=.96*this.node.width,this.scheduleBarArea.getChildByName("ScheduleBar").getComponent("ScheduleBar").scheduleChart=this.scheduleChart,this.scheduleBarArea.getChildByName("ScheduleBar").width=.96*this.node.width,this.scheduleBarArea.getChildByName("ScheduleBar").getComponent("ScheduleBar").cells=new Array(this.scheduleChart.duration/c.RESOLUTION).fill(null),this.moodBar.width=.96*this.node.width,this.taskItemArea.width=.96*this.node.width,this.clock.x=.48*-this.node.width,this.setTimeSpeed(this.scheduleChart.timeSpeed);for(var t=0,e=this.tasks;t<e.length;t++){var o=e[t];this.taskNodes.push(this._spawnNewTaskItem(o))}this.moodBar.getComponent("MoodBar").setMoodLimit(this.scheduleChart.moodLimit),this.moodBar.getComponent("MoodBar").setCurrentMoodValue(this.scheduleChart.startMood),this.moodValue=this.scheduleChart.startMood},e.prototype.start=function(){this.setTimer(0)},e.prototype.update=function(t){this.timer+=this.timeSpeed*t,this.clock.getComponent(cc.Label).string=p(this.timer+this.scheduleChart.startTime),this.moodBar.getComponent("MoodBar").setTargetMoodValue(this.moodValue),this.timer>=this.scheduleChart.duration&&this.gameResult()},i([d({type:cc.Prefab})],e.prototype,"positiveTaskItemPrefab",void 0),i([d({type:cc.Prefab})],e.prototype,"mutualTaskItemPrefab",void 0),i([d({type:cc.Prefab})],e.prototype,"negativeTaskItemPrefab",void 0),i([d(cc.Node)],e.prototype,"clock",void 0),i([d(cc.Node)],e.prototype,"scheduleBarArea",void 0),i([d(cc.Node)],e.prototype,"taskItemArea",void 0),i([d(cc.Node)],e.prototype,"moodBar",void 0),i([d(cc.Node)],e.prototype,"gameOverNode",void 0),i([d],e.prototype,"timeSpeed",void 0),i([d],e.prototype,"timer",void 0),i([d],e.prototype,"moodValue",void 0),i([s],e)}(cc.Component);function p(t){var e=Math.floor(t/60),o=Math.floor(t%60);return(e<10?"0"+e:""+e)+":"+(o<10?"0"+o:""+o)}o.default=u,cc._RF.pop()},{"./ScheduleBar":"ScheduleBar"}],MoodBar:[function(t,e,o){"use strict";cc._RF.push(e,"d860c8QsBZCR7q0/efhFPxE","MoodBar");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=c.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.positiveIcon=null,e.negativeIcon=null,e.mutualIcon=null,e.positiveMoodBar=null,e.negativeMoodBar=null,e.currentMoodValue=0,e.targetMoodValue=0,e.moodLimit=100,e.game=null,e.incrementSpeed=15,e}return n(e,t),e.prototype.setCurrentMoodValue=function(t){this.currentMoodValue=t},e.prototype.setTargetMoodValue=function(t){this.targetMoodValue=t},e.prototype.setMoodLimit=function(t){this.moodLimit=t},e.prototype.addMoodValue=function(t){this.targetMoodValue+=t},e.prototype.onLoad=function(){this.node.cascadeOpacity=!1},e.prototype.start=function(){},e.prototype.update=function(t){this.currentMoodValue<this.targetMoodValue?this.currentMoodValue=Math.min(this.targetMoodValue,this.currentMoodValue+this.incrementSpeed*t):this.currentMoodValue>this.targetMoodValue&&(this.currentMoodValue=Math.max(this.targetMoodValue,this.currentMoodValue-this.incrementSpeed*t)),this.currentMoodValue>=0?(this.negativeMoodBar.width=0,this.positiveMoodBar.width=Math.min(1,Math.abs(this.currentMoodValue)/this.moodLimit)*this.node.width/2,this.positiveMoodBar.active=!0,this.negativeIcon.active=!1,0==this.currentMoodValue?(this.positiveIcon.active=!1,this.mutualIcon.active=!0):(this.mutualIcon.active=!1,this.positiveIcon.active=!0,this.positiveIcon.setPosition(Math.min(1,Math.abs(this.currentMoodValue)/this.moodLimit)*this.node.width/2,0))):(this.positiveMoodBar.width=0,this.negativeMoodBar.width=Math.min(1,Math.abs(this.currentMoodValue)/this.moodLimit)*this.node.width/2,this.negativeMoodBar.active=!0,this.positiveIcon.active=!1,this.mutualIcon.active=!1,this.negativeIcon.active=!0,this.negativeIcon.setPosition(Math.max(-1,-Math.abs(this.currentMoodValue)/this.moodLimit)*this.node.width/2,0),Math.abs(this.currentMoodValue)>=this.moodLimit&&this.game.getComponent("Game").gameOver())},i([s(cc.Node)],e.prototype,"positiveIcon",void 0),i([s(cc.Node)],e.prototype,"negativeIcon",void 0),i([s(cc.Node)],e.prototype,"mutualIcon",void 0),i([s(cc.Node)],e.prototype,"positiveMoodBar",void 0),i([s(cc.Node)],e.prototype,"negativeMoodBar",void 0),i([s(cc.Float)],e.prototype,"currentMoodValue",void 0),i([s(cc.Float)],e.prototype,"targetMoodValue",void 0),i([s(cc.Float)],e.prototype,"moodLimit",void 0),i([s(cc.Node)],e.prototype,"game",void 0),i([s(cc.Float)],e.prototype,"incrementSpeed",void 0),i([a],e)}(cc.Component);o.default=d,cc._RF.pop()},{}],ScheduleBarIcon:[function(t,e,o){"use strict";cc._RF.push(e,"fe6d3pMFcVO3bcUKrMN8L6O","ScheduleBarIcon");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.swingDuration=1,e.swingAngle=25,e}return n(e,t),e.prototype.runSwingAction=function(){var t=cc.tween().by(this.swingDuration,{angle:-this.swingAngle},{easing:"sineOut"}),e=cc.tween().by(this.swingDuration,{angle:this.swingAngle},{easing:"sineOut"}),o=cc.tween().sequence(t,e);return cc.tween().repeatForever(o)},e.prototype.start=function(){var t=this.runSwingAction();cc.tween(this.node).then(t).start()},i([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],ScheduleBar:[function(t,e,o){"use strict";cc._RF.push(e,"b8f44/8a7xLB6OW5iPvqCW8","ScheduleBar");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0}),o.RESOLUTION=void 0;var c=t("./Schedule");o.RESOLUTION=15;var a=new cc.Node,s=cc._decorator,d=s.ccclass,u=s.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.scheduleChart=null,e.cells=[],e.game=null,e.currentCellIndex=-1,e}return n(e,t),e.prototype._checkFreeSpace=function(t,e){for(var o=Math.floor(t/(this.node.width/this.cells.length)),r=o;r<o+e;r++)if(null!=this.cells[r]||r>=this.cells.length)return-1;return o},e.prototype._markOccupied=function(t,e,o){for(var r=t;r<t+e;r++)this.cells[r]=o;return this.cells},e.prototype.markFree=function(t){var e=this.cells.findIndex(function(e){return e&&e.getComponent("TaskItem")&&e.getComponent("TaskItem").id===t.getComponent("TaskItem").id},this),r=t.getComponent("TaskItem").getTaskDuration();if(-1==e||-1==r)return-1;for(var n=e;n<e+r/o.RESOLUTION;n++)this.cells[n]=null;return r},e.prototype._durationToPixel=function(t){return Math.floor(this.node.width*t/this.scheduleChart.duration)},e.prototype.validate=function(t,e){var r=e.getComponent("TaskItem").getTaskDuration()/o.RESOLUTION,n=this._checkFreeSpace(t.x,r);return n>=0?(console.log("freeIndex in Validate(): "+n),this._markOccupied(n,r,e),cc.v2(n*this.node.width/this.cells.length,this.node.y)):null},e.prototype.insertFixedTask=function(t,e,r){var n=Math.floor(t/o.RESOLUTION);return this._markOccupied(n,e/o.RESOLUTION,r),cc.v2(n*this.node.width/this.cells.length,this.node.y)},e.prototype.onLoad=function(){for(this.currentCellIndex=-1;this.cells.length<this.scheduleChart.duration/o.RESOLUTION;)this.cells.push(null)},e.prototype.start=function(){},e.prototype.update=function(){var t=this.game.getComponent("Game").timer,e=Math.floor(t/o.RESOLUTION);e!==this.currentCellIndex&&(this.currentCellIndex=e,console.log(e),this.cells[e]&&0==this.cells[e].getComponent("TaskItem").used?(this.game.getComponent("Game").addMoodValue(this.cells[e].getComponent("TaskItem").task.moodEffect),this.cells[e].getComponent("TaskItem").used=!0,this.cells[e].getComponent("TaskItem").canMove=!1):this.cells[e]=a),this.node.parent.getChildByName("TimeMask").width=t/this.scheduleChart.duration*this.node.width,this.node.parent.getChildByName("Icon").setPosition(t/this.scheduleChart.duration*this.node.width,0)},i([u({type:c.default})],e.prototype,"scheduleChart",void 0),i([u([cc.Node])],e.prototype,"cells",void 0),i([u(cc.Node)],e.prototype,"game",void 0),i([d],e)}(cc.Component);o.default=p,cc._RF.pop()},{"./Schedule":"Schedule"}],Schedule:[function(t,e,o){"use strict";cc._RF.push(e,"31978rNHzJFPbsLiMIBXZTb","Schedule");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,c=n.property,a=function(){function t(){this.duration=0,this.startTime=0,this.startMood=0,this.moodLimit=100,this.timeSpeed=10}return r([c(cc.Integer)],t.prototype,"duration",void 0),r([c(cc.Integer)],t.prototype,"startTime",void 0),r([c(cc.Integer)],t.prototype,"startMood",void 0),r([c(cc.Integer)],t.prototype,"moodLimit",void 0),r([c(cc.Float)],t.prototype,"timeSpeed",void 0),r([i("Schedule")],t)}();o.default=a,cc._RF.pop()},{}],TaskItemAreaLayout:[function(t,e,o){"use strict";cc._RF.push(e,"b3a7a4EofBK9LYWiCrXJzFL","TaskItemAreaLayout");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=cc._decorator,a=c.ccclass,s=(c.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.rearrange=function(){this.node.getComponent(cc.Layout).type=cc.Layout.Type.GRID,this.node.getComponent(cc.Layout).updateLayout(),this.node.getComponent(cc.Layout).type=cc.Layout.Type.NONE},e.prototype.onLoad=function(){this.rearrange()},e.prototype.start=function(){this.rearrange()},i([a],e)}(cc.Component));o.default=s,cc._RF.pop()},{}],TaskItem:[function(t,e,o){"use strict";cc._RF.push(e,"25813lLRo9DL7xNFevBNsY4","TaskItem");var r,n=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var c=t("./Task"),a=cc._decorator,s=a.ccclass,d=a.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.id="testid",e.labelTemplate=null,e.task=null,e.scheduleBar=null,e.taskItemAreaLayout=null,e.canMove=!0,e.used=!1,e._oldPosition=null,e.target=null,e.scheduleBarRect=null,e.taskItemAreaRect=null,e}return n(e,t),e.prototype.getTaskDuration=function(){return this.task?this.task.duration:-1},e.prototype._spawnLabel=function(){var t=cc.instantiate(this.labelTemplate);t.width=.95*this.node.width,t.getComponent(cc.Label).string=this.task.text,this.node.addChild(t)},e.prototype._onTouchMove=function(t){if(this.canMove){this.node.parent===this.scheduleBar&&(this.node.parent=this.taskItemAreaLayout,this.scheduleBar.getComponent("ScheduleBar").markFree(this.node));var e=t.getLocation();this.node.position=this.node.parent.convertToNodeSpaceAR(e)}},e.prototype._onTouchEnd=function(t){if(this.canMove){this.node.scale=1,this.taskItemAreaRect=this.taskItemAreaLayout.getBoundingBox(),this.scheduleBarRect=this.scheduleBar.getBoundingBox();var e=t.getLocation(),o=this.scheduleBar.parent.convertToNodeSpaceAR(e);if(this.scheduleBarRect.contains(cc.v2(o.x,o.y))){var r=this.scheduleBar.convertToNodeSpaceAR(e),n=this.scheduleBar.getComponent("ScheduleBar").validate(r,this.node);if(null!=n)return this.node.parent=this.scheduleBar,this.node.position=n,void this.taskItemAreaLayout.getComponent("TaskItemAreaLayout").rearrange()}return this.node.parent=this.taskItemAreaLayout,void this.taskItemAreaLayout.getComponent("TaskItemAreaLayout").rearrange()}},e.prototype.onLoad=function(){var t=this;if(!this.task)throw"None task found for onLoad()!";this._spawnLabel(),this._oldPosition=this.node.position,this.node.on(cc.Node.EventType.TOUCH_START,function(){t._oldPosition=t.node.position},this),this.node.on(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.on(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this)},e.prototype.onDestroy=function(){var t=this;this.node.off(cc.Node.EventType.TOUCH_START,function(){t._oldPosition=t.node.position},this),this.node.off(cc.Node.EventType.TOUCH_MOVE,this._onTouchMove,this),this.node.off(cc.Node.EventType.TOUCH_END,this._onTouchEnd,this)},e.prototype.start=function(){},e.prototype.update=function(){},i([d(cc.String)],e.prototype,"id",void 0),i([d(cc.Prefab)],e.prototype,"labelTemplate",void 0),i([d({type:c.default})],e.prototype,"task",void 0),i([d(cc.Node)],e.prototype,"scheduleBar",void 0),i([d(cc.Node)],e.prototype,"taskItemAreaLayout",void 0),i([d(cc.Boolean)],e.prototype,"canMove",void 0),i([d(cc.Boolean)],e.prototype,"used",void 0),i([s],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./Task":"Task"}],Task:[function(t,e,o){"use strict";cc._RF.push(e,"dae42QzZp9LbZjhfBI22RQ3","Task");var r=this&&this.__decorate||function(t,e,o,r){var n,i=arguments.length,c=i<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)c=Reflect.decorate(t,e,o,r);else for(var a=t.length-1;a>=0;a--)(n=t[a])&&(c=(i<3?n(c):i>3?n(e,o,c):n(e,o))||c);return i>3&&c&&Object.defineProperty(e,o,c),c};Object.defineProperty(o,"__esModule",{value:!0});var n=cc._decorator,i=n.ccclass,c=n.property,a=function(){function t(){this.text="",this.duration=0,this.moodEffect=0,this.triggerFailureString="",this.fixedTime=-1}return r([c(cc.String)],t.prototype,"text",void 0),r([c(cc.Integer)],t.prototype,"duration",void 0),r([c(cc.Integer)],t.prototype,"moodEffect",void 0),r([c(cc.String)],t.prototype,"triggerFailureString",void 0),r([c(cc.Integer)],t.prototype,"fixedTime",void 0),r([i("task")],t)}();o.default=a,cc._RF.pop()},{}]},{},["FastForward","Game","MoodBar","Schedule","ScheduleBar","ScheduleBarIcon","Task","TaskItem","TaskItemAreaLayout"]);
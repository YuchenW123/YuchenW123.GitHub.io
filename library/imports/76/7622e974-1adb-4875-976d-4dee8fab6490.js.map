{"version":3,"sources":["assets\\Script\\Game.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["// Learn TypeScript:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/typescript.html\r\n// Learn Attribute:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/reference/attributes.html\r\n// Learn life-cycle callbacks:\r\n//  - https://docs.cocos.com/creator/manual/en/scripting/life-cycle-callbacks.html\r\nimport Schedule from './Schedule';\r\nimport { RESOLUTION } from './ScheduleBar';\r\nimport Task from './Task';\r\n\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class Game extends cc.Component {\r\n    @property(\r\n        {type: cc.Prefab}\r\n    )\r\n    positiveTaskItemPrefab: cc.Prefab = null;\r\n\r\n    @property(\r\n        {type: cc.Prefab}\r\n    )\r\n    mutualTaskItemPrefab: cc.Prefab = null;\r\n\r\n    @property(\r\n        {type: cc.Prefab}\r\n    )\r\n    negativeTaskItemPrefab: cc.Prefab = null;\r\n\r\n    @property(cc.Node)\r\n    clock: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    scheduleBarArea: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    taskItemArea: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    moodBar: cc.Node = null;\r\n\r\n    @property(cc.Node)\r\n    gameOverNode = null;\r\n\r\n    @property\r\n    timeSpeed = 1;\r\n\r\n    @property\r\n    timer = 0;\r\n\r\n    @property\r\n    moodValue = 0;\r\n\r\n    scheduleChart: Schedule = {\r\n        duration: 360,\r\n        moodLimit: 50,\r\n        startMood: 0,\r\n        startTime: 660,\r\n        timeSpeed: 1,\r\n    }\r\n\r\n    taskNodes: cc.Node[] = [];\r\n\r\n    tasks: Task[] = [\r\n        {\r\n            text: \"洗脸\",\r\n            moodEffect: -10,\r\n            triggerFailureString: \"怎么灰头土脸见人啊！\",\r\n            duration: 60,\r\n            fixedTime: -1,\r\n        },\r\n        {\r\n            text: \"化妆\",\r\n            moodEffect: -25,\r\n            triggerFailureString: \"不化妆绝对不会出门的！\",\r\n            duration: 60,\r\n            fixedTime: -1,\r\n        },\r\n        {\r\n            text: \"起床\",\r\n            moodEffect: -25,\r\n            duration: 45,\r\n            fixedTime: 0,\r\n        },\r\n        {\r\n            text: \"拉屎\",\r\n            moodEffect: 25,\r\n            duration: 45,\r\n            fixedTime: -1,\r\n        },\r\n        {\r\n            text: \"赖床\",\r\n            moodEffect: +50,\r\n            duration: 45,\r\n            fixedTime: -1,\r\n        },\r\n        {\r\n            text: \"挑穿衣服\",\r\n            moodEffect: -50,\r\n            duration: 45,\r\n            fixedTime: -1,\r\n            triggerFailureString:\"穿衣服穿太久了!\",\r\n        },\r\n        {\r\n            text: \"磨蹭\",\r\n            moodEffect: 0,\r\n            duration: 45,\r\n            fixedTime: 150,\r\n        }\r\n    ]\r\n\r\n    setTimeSpeed(newValue: number) {\r\n        this.timeSpeed = newValue;\r\n    }\r\n\r\n    setTimer(newValue:number) {\r\n        this.timer = newValue\r\n    }\r\n\r\n    setMoodValue(newValue: number) {\r\n        this.moodValue = newValue;\r\n        this.moodBar.getComponent(\"MoodBar\").setTargetMoodValue(newValue);\r\n    }\r\n\r\n    addMoodValue(newValue: number) {\r\n        this.moodValue += newValue;\r\n        this.moodBar.getComponent(\"MoodBar\").setTargetMoodValue(this.moodValue);\r\n    }\r\n\r\n    _spawnNewTaskItem(task: Task) {\r\n        let randomeId = \"00\" + Math.random();\r\n        let newTaskItem: cc.Node = null;\r\n\r\n        if (task.moodEffect > 0) {\r\n            newTaskItem = cc.instantiate(this.negativeTaskItemPrefab);\r\n        } else if (task.moodEffect == 0) {\r\n            newTaskItem = cc.instantiate(this.mutualTaskItemPrefab);\r\n        } else {\r\n            newTaskItem = cc.instantiate(this.positiveTaskItemPrefab);\r\n        }\r\n\r\n        newTaskItem.getComponent(cc.Sprite).type = cc.Sprite.Type.SLICED;\r\n\r\n        newTaskItem.getComponent(\"TaskItem\").task = task;\r\n        newTaskItem.getComponent(\"TaskItem\").id = randomeId;\r\n        // newTaskItem.getComponent(cc.Sprite).sizeMode = cc.Sprite.SizeMode.TRIMMED;\r\n\r\n        newTaskItem.width = Math.floor(this.scheduleBarArea.getChildByName(\"ScheduleBar\").width * task.duration / this.scheduleChart.duration * 0.9);\r\n        newTaskItem.height = this.scheduleBarArea.getChildByName(\"ScheduleBar\").height*0.9;\r\n        newTaskItem.getComponent(\"TaskItem\").scheduleBar = this.scheduleBarArea.getChildByName(\"ScheduleBar\");\r\n        newTaskItem.getComponent(\"TaskItem\").taskItemAreaLayout = this.taskItemArea;\r\n        \r\n        if (task.fixedTime >= 0) {\r\n            // Add to scheduleBar\r\n            newTaskItem.getComponent(\"TaskItem\").canMove = false;\r\n            this.scheduleBarArea.getComponentInChildren(\"ScheduleBar\").node.addChild(newTaskItem);\r\n            newTaskItem.position = this.scheduleBarArea.getComponentInChildren(\"ScheduleBar\").insertFixedTask(task.fixedTime, task.duration, newTaskItem);\r\n        } else {\r\n            // Add to task item area\r\n            this.taskItemArea.addChild(newTaskItem);\r\n            this.taskItemArea.getComponent(\"TaskItemAreaLayout\").rearrange();\r\n        }\r\n        return newTaskItem;\r\n    }\r\n\r\n    gameOver() {\r\n        // Enable fail window and display sudden death message\r\n        this.node.getChildByName(\"GameOverScreen\").active = true;\r\n    }\r\n\r\n    perfectWin() {\r\n        // Enable win window and display perfect message\r\n        this.win();\r\n    }\r\n\r\n    win() {\r\n        // Enable win window and display win message\r\n        this.node.getChildByName(\"WinScreen\").active = true;\r\n    }\r\n\r\n    lose(failString: string) {\r\n        // Enable lose window and display message from canditates\r\n        this.node.getChildByName(\"LoseScreen\").getChildByName(\"label\").getComponent(cc.Label).string = failString;\r\n        this.node.getChildByName(\"LoseScreen\").active = true;\r\n    }\r\n\r\n    gameResult() {\r\n        this.timeSpeed = 0;\r\n\r\n        for (let item of this.taskNodes) {\r\n            if (item.getComponent(\"TaskItem\").used == false && item.getComponent(\"TaskItem\").task.moodEffect < 0) {\r\n                let failString = item.getComponent(\"TaskItem\").task.triggerFailureString;\r\n                this.lose(failString);\r\n                return;\r\n            }\r\n        }\r\n        if (this.moodValue >= 0) {\r\n            this.perfectWin();\r\n        } else {\r\n            this.win();\r\n        }\r\n    }\r\n\r\n    // LIFE-CYCLE CALLBACKS:\r\n\r\n    onLoad () {\r\n        this.node.getChildByName(\"WinScreen\").active = false;\r\n        this.scheduleBarArea.x = -this.node.width*0.48\r\n        this.scheduleBarArea.width = this.node.width * 0.96;\r\n        this.scheduleBarArea.getChildByName(\"ScheduleBar\").getComponent(\"ScheduleBar\").scheduleChart = this.scheduleChart;\r\n        this.scheduleBarArea.getChildByName(\"ScheduleBar\").width = this.node.width * 0.96;\r\n        this.scheduleBarArea.getChildByName(\"ScheduleBar\").getComponent(\"ScheduleBar\").cells = new Array(this.scheduleChart.duration/RESOLUTION).fill(null);\r\n        this.moodBar.width = this.node.width * 0.96;\r\n        this.taskItemArea.width = this.node.width * 0.96;\r\n        this.clock.x = -this.node.width*0.48;\r\n\r\n        this.setTimeSpeed(this.scheduleChart.timeSpeed);\r\n\r\n        for (let item of this.tasks) {\r\n           this.taskNodes.push(this._spawnNewTaskItem(item));\r\n        }\r\n\r\n        this.moodBar.getComponent(\"MoodBar\").setMoodLimit(this.scheduleChart.moodLimit);\r\n        this.moodBar.getComponent(\"MoodBar\").setCurrentMoodValue(this.scheduleChart.startMood);\r\n        this.moodValue = this.scheduleChart.startMood;\r\n    }\r\n\r\n    start () {\r\n        this.setTimer(0);\r\n    }\r\n\r\n    update (dt) {\r\n        this.timer += this.timeSpeed * dt;\r\n        this.clock.getComponent(cc.Label).string = intToTime(this.timer + this.scheduleChart.startTime);\r\n        this.moodBar.getComponent(\"MoodBar\").setTargetMoodValue(this.moodValue);\r\n        if (this.timer >= this.scheduleChart.duration) {\r\n            this.gameResult();\r\n        }\r\n    }\r\n}\r\n\r\nfunction intToTime(timer: number) {\r\n    let hours = Math.floor(timer / 60);\r\n    let minutes = Math.floor(timer % 60);\r\n    return (hours < 10 ? (\"0\" + hours) : \"\"+hours) + \":\" +(minutes < 10?(\"0\"+minutes) : \"\"+ minutes);\r\n}\r\n"]}